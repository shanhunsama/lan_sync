# 局域网文件夹同步工具 (Python)

这是一个简单的 Python 工具，用于在局域网内两台电脑之间同步当前文件夹下的所有文件（包含子目录）。

要点：
- 运行环境：Python 3.8+
- 无需第三方依赖（仅标准库）
- 支持双向同步和单向传输两种模式
- 冲突策略：使用文件修改时间（mtime）较新的版本覆盖；使用 SHA256 校验避免不必要传输
- 默认不删除任何文件（仅新增/更新）。删除支持可作为后续改进。

## 使用示例

### 双向同步模式（推荐用于双向文件同步）

在机器 A（监听）：

```powershell
python sync.py --listen --port 9000
```

在机器 B（连接到 A）：

```powershell
python sync.py --connect 192.168.1.100 --port 9000
```

将 `192.168.1.100` 替换为机器 A 的局域网 IP。两端启动后，脚本会交换当前目录下的文件清单，比较差异，然后互相请求并传输缺失或较新的文件。

### 单向传输模式（推荐用于文件分发）

在发送方机器：

```powershell
python sync.py --send --port 9000
```

在接收方机器：

```powershell
python sync.py --receive 192.168.1.100 --port 9000
```

单向模式下，发送方会将所有文件发送给接收方，接收方会覆盖本地文件。

## 模式对比

| 模式 | 特点 | 适用场景 |
|------|------|----------|
| 双向同步 | 双方互相比较文件差异，只传输有变化的文件 | 双向协作，文件共享 |
| 单向发送 | 发送方发送所有文件给接收方 | 文件分发，备份恢复 |
| 单向接收 | 接收方接收所有来自发送方的文件 | 接收更新，镜像同步 |

## GUI 前端

仓库还包含一个简单的 Qt GUI 前端 `gui.py`（基于 PyQt5），可以更方便地选择目录并启动/停止同步进程：

```powershell
python gui.py
```

GUI 将以所选目录作为工作目录运行 `sync.py`，并在窗口内显示同步程序的输出日志。

限制与后续改进建议：
- 目前为一次性同步（运行一次完成同步），后续可以添加守护模式（watch）实现实时同步；
- 默认不处理文件删除；可以添加 `--delete` 选项以实现镜像行为（慎用）；
- 目前冲突以 mtime 判断，网络和系统时间不同步时可能导致误判，后续可引入手动冲突解决或 vector clocks；
- 未实现断点续传（可在大文件场景中改进）。

安全提示：在不受信任网络上使用要谨慎，此工具未做强认证和加密。可以在受控局域网或 VPN 内使用，或在 TCP 之上加 TLS。